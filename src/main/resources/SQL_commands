#########Команды postgresql для создания Базы данных голосования#####################

CREATE SCHEMA domodel;

SET SEARCH_PATH TO domodel;

### МОДУЛЬ АВТОРИЗАЦИИ ###
CREATE TABLE users (id bigserial not null, login varchar(100) not null UNIQUE, password varchar(255) not null, enabled boolean not null, creation_date timestamp not null, first_name varchar(255), second_name varchar(255), middle_name varchar(255), phone_number varchar(255) UNIQUE, email varchar(255) UNIQUE, PRIMARY KEY (id));
CREATE TABLE authorities (id bigserial not null, user_id bigint not null, authority varchar(100) not null, FOREIGN KEY (user_id) REFERENCES users (id), PRIMARY KEY (id));
INSERT INTO users (login, password, enabled, creation_date, first_name, second_name, middle_name, phone_number, email) VALUES ('admin', '$2a$10$ArsakpPHT5jPbPEAeVc/lup1V4tJS9hqaa1PfRNIUy459JkPjK5xS', true, '2020-08-08', 'Ivan', 'Ivanov', 'Ivanovich', '9123456789', 'ivan@mail.ru');
INSERT INTO authorities (user_id, authority) VALUES (1, 'ROLE_ADMIN');

### МОДУЛЬ НОВОСТЕЙ ###
CREATE TABLE news (id bigserial not null, creation_date timestamp not null, short_text varchar(255) not null, text varchar(2000) not null, visible boolean not null, picture varchar(255), type varchar(100), author bigint not null, FOREIGN KEY (author) REFERENCES users (id), PRIMARY KEY (id));
INSERT INTO news (creation_date, short_text, text, visible, picture, type, author) VALUES ('2020-08-06', 'Short text description', 'Full text description of the news number one', true, 'http://Link_for_picture', 'ANNOUNCE', 1);

### МОДУЛЬ ПЛАТЕЖЕЙ ###
create table bills (id  serial not null, credentials varchar(255) not null, payment_status varchar(255) not null, price float not null, target varchar(255) not null, type varchar(255) not null, user_id int8, primary key (id));

### МОДУЛЬ СЧЕТЧИКОВ ###
create table houses (id serial not null, number varchar(255) not null, street varchar(255), user_id int not null, FOREIGN KEY (user_id) REFERENCES users (id), primary key (id));
create table meters (id serial not null, number int not null, type varchar(255) not null, house_id int not null, FOREIGN KEY (user_id) REFERENCES users (id), primary key (id));

### РАБОТА С БД ###

SELECT * FROM products;
SELECT * FROM users;
SELECT * FROM authorities;

DROP TABLE news;
DROP TABLE authorities;
DROP TABLE users CASCADE;
