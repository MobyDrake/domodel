<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="utf-8"/>

    <title>Главная страница</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
</head>

<body>

<div class="container">
    <h1>Главная страница</h1>
</div>
<div class="container">
    <div id="loginbox" style="margin-top: 50px;" class="mainbox col-md-3 col-md-offset-2 col-sm-6 col-sm-offset-2" sec:authorize="isAnonymous()">

        <div th:if="${user != null}">
            <div th:text="'Создан пользователь с именем: ' + ${user.getLogin()}"/>
        </div>

        <div class="panel panel-info">
            <div class="panel-title">
                <b>Пожалуйста войдите в свой аккаунт</b>
            </div>
            <div style="padding-top: 30px" class="panel-body">
                <form th:action="@{/authenticateTheUser}" method="POST" class="form-horizontal">
                    <div style="margin-bottom: 25px" class="input-group">
                        <input type="text" name="login" placeholder="логин" class="form-control">
                    </div>
                    <div style="margin-bottom: 25px" class="input-group">
                        <input type="password" name="password" placeholder="пароль" class="form-control">
                    </div>
                    <div th:if="${user == null && error != null}">
                        <small class="form-text text-danger" th:text="${error}"></small>
                    </div>
                    <div>
                        Запомнить меня: <input type="checkbox" name="remember-me" checked/>
                    </div>
                    <div style="margin-top: 10px" class="form-group">
                        <button type="submit" class="btn btn-success">Войти</button>
                    </div>
                </form>
            </div>

            <div class="panel-title">
                <b>Либо создайте нового пользователя:</b>
            </div>
            <div style="padding-top: 30px" class="panel-body">
                <form th:action="@{/createUser}" method="POST" class="form-horizontal" th:object="${request}">
                    <div style="margin-bottom: 25px" class="input-group">
                        <input type="text" id="login" th:field="*{login}" placeholder="имя пользователя" class="form-control">
                        <small class="form-text text-danger" th:each="err : ${#fields.errors('login')}" th:text="${err}">Validation errors</small>
                    </div>
                    <div style="margin-bottom: 25px" class="input-group">
                        <input type="password" id="password" th:field="*{password}" placeholder="пароль" class="form-control">
                        <small class="form-text text-danger" th:each="err : ${#fields.errors('password')}"  th:text="${err}">Validation errors</small>
                    </div>
                    <div style="margin-bottom: 25px" class="input-group">
                        <input type="password" id="passwordConfirm" th:field="*{passwordConfirm}" placeholder="подтвердите пароль" class="form-control">
                        <small  class="form-text text-danger" th:each="err : ${#fields.errors('passwordConfirm')}" th:text="${err}">Validation errors</small>
                    </div>
                    <div style="margin-top: 10px" class="form-group">
                        <button type="submit" class="btn btn-success">Создать пользователя</button>
                        <button type="reset" class="btn btn-danger">Очистить форму</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div  class="container" sec:authorize="hasRole('USER')">
        <div class="panel-title"><b>Спасибо, что вошли в систему как пользователь!</b><br><br>
            Пожалуйста перейдите в <a th:href="@{/news}">раздел новости</a>,
        </div>
    </div>
    <div  class="container" sec:authorize="hasRole('ADMIN')">
        <div class="panel-title"><b>Вы вошли как администратор!</b><br>
        </div>
    </div>
</div>
</body>
</html>
